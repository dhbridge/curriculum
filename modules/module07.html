<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="" />
	  <meta name="viewport" content="width=device-width, user-scalable=no">
	
    <link href='http://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic|Nova+Square' rel='stylesheet' type='text/css'>
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">

    <title>Functions and Loops</title>

    <link href="../stylesheets/codes.css" rel="stylesheet" type="text/css" />
    <link href="../stylesheets/style.css" rel="stylesheet" type="text/css" />
  </head>

  <body class="modules modules_module07">
    <!-- HEADER -->
        <header>
				<div class="wrap">
	    <h1 id="project_title">DH Bridge</h1>
	    <h2 class="tag">Encouraging Computational Thinking and Digital Skills in the Humanities</h2>

	    <nav id="pages">
	    	<a href="/">Computational Thinking</a>
	    	<a href="http://dhbridge.org">About DH Bridge</a>
	    </nav>
	</div>
        </header> 
        <!-- MAIN CONTENT -->
        <div class="wrap">
            <div id="main">
              <article>
                		<section id="sidebar">
			<h2>Modules</h2>
			<a href="/modules/installation.html">Installation Instructions</a>
			<a href="/modules/coaches-guide.html">Coaches Guide</a>

			<ol>
			<li><a href="/modules/module01.html">Working with your Computer</a></li>
			<li><a href="/modules/module02.html">Thinking about Data</a></li>
			<li><a href="/modules/module03.html">Getting Data</a></li>
			<li><a href="/modules/module04.html">Working with the API</a></li>
			<li><a href="/modules/module05.html">Writing Script Files</a></li>
			<li><a href="/modules/module06.html">Phase Two</a></li>
			<li><a href="/modules/module07.html">Using Functions and Loops</a></li>
			<li><a href="/modules/module08.html">Using While-Loops</a></li>
			<li><a href="/modules/module09.html">Writing Results to File</a></li>
			<li><a href="/modules/module10.html">Working with Local Data</a></li>
			<li><a href="/modules/module11.html">Analyzing the Data (Part 1)</a></li>
			<li><a href="/modules/module12.html">Analyzing the Data (Part 2)</a></li>
			<li><a href="/modules/module13.html">Saving Results to a File</a></li>
			<li><a href="/modules/module14.html">Next Steps</a></li>
			</ol>
		</section>

                <section id="content">
                        <h2>
          Functions and Loops
      </h2>
       <p>In this module, we will learn to:</p>

<ol>
  <li>to create and call functions</li>
  <li>to create a "for" loop and "append" (add) items to a list</li>
</ol>

<p>We are now ready to start writing a function to gather all of the information we want from the DPLA.</p>

<p>Our file currently looks like this:</p>

<div class="highlight plaintext"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12</pre></td><td class="code"><pre># Load Libraries
from dpla.api import DPLA

# Set Variables
dpla = DPLA('Your-Key-Here')
# result = dpla.search('cooking', fields=['sourceResource'], page_size = 50)
all_records = []

# Define Functions

# Make Function Calls
# print result.items[1]
</pre></td></tr></tbody></table>
</div>

<p>We will now add a function that handles the query for any given page number.</p>

<h3 id="creating-a-pull-records-function">1. Creating a "Pull Records" Function</h3>

<p>Functions are little blocks of code that do particular tasks. They involve variables and logic, they take what is given to them, and return a result.</p>

<p>To write a function, we start with the keyword "<code>def</code>", then give our function a name, and finally end with '<code>():</code>' Inside the parentheses, we can indicate how many pieces of information are going into the function.</p>

<p>In your "<code>my_first_script.py</code>" file, add the line</p>

<div class="highlight plaintext"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2</pre></td><td class="code"><pre># Define Functions
def pull_records(pages, end, size):
</pre></td></tr></tbody></table>
</div>

<p>In this line, you have declared a '<code>pull_records</code>' function, and told Python that this function will involve three variables (<code>pages</code>, <code>end</code>, and <code>size</code>). These three variables names can be anything you like (you could name them "<code>snap</code>", "<code>crackle</code>", and "<code>pop</code>"), but should be meaningful to the their role in the function. In our case, they will hold information for the first page and last page, and the number of items per page.</p>

<p>We are now ready to add the steps involved in getting the search records.</p>

<p>On the next line, tab in once and type:</p>

<div class="highlight plaintext"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre># Define Functions
def pull_records(pages, end, size):
	paged_search = dpla.search('cooking', fields=['sourceResource'], page_size=size, page=pages)
</pre></td></tr></tbody></table>
</div>

<p>Your file should now look like this:</p>

<div class="highlight plaintext"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14</pre></td><td class="code"><pre># Load Libraries
from dpla.api import DPLA

# Set Variables
dpla = DPLA('Your-Key-Here')
# result = dpla.search('cooking', fields=['sourceResource'], page_size = 50)
all_records = []

# Define Functions
def pull_records(pages, end, size):
	paged_search = dpla.search('cooking', fields=['sourceResource'], page_size=size, page=pages)

# Make Function Calls
# print result.items[1]
</pre></td></tr></tbody></table>
</div>

<p>It is important to note that in Python, white-space has meaning: when writing functions in Python, white space is used to designate what is in a function or within a loop and what is outside of it.</p>

<p>Let's add a "<code>print</code>" statement to our function and test out the first stage of this function. On the next line, tab in and add the following "<code>print</code>" statement after "<code>paged_search</code>â€¦":</p>

<div class="highlight plaintext"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4</pre></td><td class="code"><pre># Define Functions
def pull_records(pages, end, size):
	paged_search = dpla.search('cooking', fields=['sourceResource'], page_size = size, page = pages)
	print paged_search.items[2]
</pre></td></tr></tbody></table>
</div>

<p>To execute the function, we will call the function name and give it values. On a new line in the 'Make Function Calls' section, add the line:</p>

<div class="highlight plaintext"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre># Make Function Calls
# print result.items[1]
pull_records(2, 3, 50)
</pre></td></tr></tbody></table>
</div>

<p>Your file should now look like:</p>

<div class="highlight plaintext"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16</pre></td><td class="code"><pre># Load Libraries
from dpla.api import DPLA

# Set Variables
dpla = DPLA('Your-Key-Here')
# result = dpla.search('cooking', fields=['sourceResource'], page_size = 50)
all_records = []

# Define Functions
def pull_records(pages, end, size):
	paged_search = dpla.search('cooking', fields=['sourceResource'], page_size = size, page = pages)
	print paged_search.items[2]

# Make Function Calls
# print result.items[1]
pull_records(2, 3, 50)
</pre></td></tr></tbody></table>
</div>

<p>Save the file and go to Terminal to run it (<code>python my_first_script.py</code>). Then come back to the function and work with your table to understand how the function works.</p>

<h3 id="using-a-for-loop-to-save-items-to-allrecords">2. Using a '<code>for</code> loop' to save items to '<code>all_records</code>'</h3>

<p>You have written and executed your first function. Well done!</p>

<p>Now we need to add another function to store those results to the empty '<code>all_records</code>' list we set up in the last module. While this is not necessary when you only have one page of results, it becomes necessary when you are trying to save from multiple pages.</p>

<p>To create a "Save Each" function, we need to define a new function in the <code>my_first_script.py</code> file. A best practice in programming is to group  functions together toward the top of the file. Let's put our "<code>save_each</code>" function after "<code>pull_records</code>" but before we call the "<code>pull_records</code>" function:</p>

<div class="highlight plaintext"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre>def save_each(n):
</pre></td></tr></tbody></table>
</div>

<p>The '<code>n</code>' here is again arbitrary (short for number). We are telling the function that there is one attribute that we will be passing in, and to take that variable and plug it in for '<code>n</code>' throughout the function.</p>

<p>We now need to add our first loop. With our current search, there are 50 items in our <code>paged_search</code> variable. We want to save each of those items separately to the "<code>all_records</code>" list. This means the computer needs to move through each individual item, grab the item, and add it to "<code>all_records</code>".</p>

<p>Tabbing in one space on the next line under <span class="command">def save_each(n):</span>s add:</p>

<div class="highlight plaintext"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre>def save_each(n):
	for each in n.items:
		# do something to every item in the list of items
</pre></td></tr></tbody></table>
</div>

<p>This is called a "<em>for loop</em>". It tells Python to iterate through each item in the list "<code>n</code>".</p>

<p>Because this logic is contained within the function, we need to add another tab. Each time we have a new loop or new function, we tab in all the lines associated with that block of code. To show that we're done listing steps for a particular bit of logic, we align the code with the appropriate amount of whitespace.</p>

<p>To add the item to the "<code>all_records</code>" list, we use the "<a href="https://docs.python.org/2/tutorial/datastructures.html">append</a>"
method:</p>

<div class="highlight plaintext"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4</pre></td><td class="code"><pre>def save_each(n):
	for each in n.items:
		# do something to every item in the list of items
		all_records.append(each)
</pre></td></tr></tbody></table>
</div>

<p>"<code>append</code>" grabs the value of "<code>each</code>" and adds it to the series we are saving as a list.</p>

<p>Now we can use this function in our "<code>pull_records</code>" function. Currently, our "<code>pull_records</code>" function looks as follows:</p>

<div class="highlight plaintext"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre>def pull_records (pages, end, size):
	paged_search = dpla.search('cooking', fields=['sourceResource'],  page_size=size, page=pages)
	print paged_search.items[2]
</pre></td></tr></tbody></table>
</div>

<p>Let's comment out the "<code>print paged_search.item[2]</code>" line, because that was just there to check that the first bit worked.</p>

<p>Now add a call to the "<code>save_each</code>" function, that passes in our search results.</p>

<div class="highlight plaintext"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4</pre></td><td class="code"><pre>def pull_records (pages, end, size):
	paged_search = dpla.search('cooking', fields=['sourceResource'],  page_size=size, page=pages)
	# print paged_search.items[2]
	save_each(paged_search)
</pre></td></tr></tbody></table>
</div>

<p>Our file should now look like:</p>

<div class="highlight plaintext"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></td><td class="code"><pre># Load Libraries
from dpla.api import DPLA

# Set Variables
dpla = DPLA('Your-Key-Here')
# result = dpla.search('cooking', fields=['sourceResource'], page_size = 50)
all_records = []

# Define Functions
def pull_records (pages, end, size):
	paged_search = dpla.search('cooking', fields=['sourceResource'],  page_size=size, page=pages)
	# print paged_search.items[2]
	save_each(paged_search)

def save_each(n):
	for each in n.items:
		# do something to every item in the list of items
		all_records.append(each)

# Make Function Calls
# print result.items[1]
pull_records(2, 3, 50)
</pre></td></tr></tbody></table>
</div>

<p>To test this, let's now add a "<code>print</code>" statement to the end of the file, after the "<code>pull_records</code>" function has been run, to make sure that the items are going into the "<code>all_records</code>" variable.</p>

<p>After "<code>pull_records()</code>" add:</p>

<div class="highlight plaintext"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre>print all_records[30]
</pre></td></tr></tbody></table>
</div>

<p>Save and run your script.</p>

<p>We have made great progress! We now have two functions to handle making the query and saving the results, but we are still only working with one "<code>page</code>" of search results at a time. In the next module, we will add yet another kind of loop in order to move through the different pages.</p>

<h3 id="group-challenge">Group Challenge</h3>

<p>Break out the paper and pencils. Work as a group to create a diagram or metaphor for a "for loop". When would a "for loop" be useful?</p>

<p><span class="left"><a href="module06.html">Previous Module</a></span>
<span class="right"><a href="module08.html">Next Module</a></span></p>



                </section>
              </article>
  			   </div>
  		</div>
  		
  		<footer>
  				<div class="wrap">
		<div id="rights">
		    <p>&copy; CC-BY 2014</p>
		    <p>The DH Bridge curriculum is supported by a microgrant from the <a href="http://ach.org/"><img src="http://dhbridge.org/images/ach-logo.png" width=50px ></a></p>
		</div>

	    <div id="contact">
	        <a href="mailto:bridgingdh@gmail.com"><i class="fa fa-paper-plane"></i></a>
	        <a href="https://twitter.com/dhbridge"><i class="fa fa-twitter"></i></a>
	        <a href="https://github.com/dhbridge/curriculum"><i class="fa fa-github"></i></a>
	    </div>
	</div>
  		</footer>

  </body>
</html>